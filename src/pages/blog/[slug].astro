---
// TODO: Builg and style this page
import type { SanityDocument } from '@sanity/client'
import PageHeader from '../../components/ui/PageHeader.astro'
import Layout from '../../layouts/Layout.astro'
import { loadQuery } from '../../sanity/lib/load-query'

export async function getStaticPaths() {
  const { data: posts } = await loadQuery<SanityDocument[]>({
    query: `*[_type == "post"]`,
  })

  return posts.map(({ slug }) => {
    return {
      params: {
        slug: slug.current,
      },
    }
  })
}

const { params } = Astro

const { data: post } = await loadQuery<SanityDocument>({
  query: `*[_type == "post" && slug.current == $slug][0]`,
  params,
})
---

<Layout title={post.title} description={post.description}>
  <PageHeader title={`${post.title}`} />

  <!-- TODO: display body content, images, etc. -->
  <!-- <PortableText portableText={post.body} /> -->
</Layout>
